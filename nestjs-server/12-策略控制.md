# 基于策略控制

## 权限控制 - 前端

- 菜单权限
- 通过路由控制

```lua
- - - - - - -  - - - - -
      前端权限
- - - - - - - - - - - - -
       |                 |
 路由1  |                 |
       |   按钮（操作）权限 |
 路由2  |                 |
       |  删除     新增    |
 路由3  |- - - - - - - - -|
```

## 后端权限

```lua
- - - - - - - - - - - - - - - - - - - -
         后端权限                        | - - - > 动态的  - - > 数据库
- - - - - - - - - - - - -  - - - - - - -
/api/user - -    接口权限 | - - > 基于角色 |
            |    数据权限 |
/api/role - - - > 守卫 - - - >    基于策略 | - -  > 静态 - - - > 程序
            |                                                 配置文件
/api/rights -                    混合策略 |
```

## RBAC (Role-based access control) 实现

```lua
# 通过 模块 + 路由 给角色打标签

用户  - - > 读取用户的角色 - - >   模块   - - - > 路由
                         |
                         | - Guard - - > 控制策略(CURD + M)
```

## ACL - 基于策略的权限控制: 数据权限控制

- 权限，接口，菜单 全部放在数据库当中

```lua
                                                                      ACL               字段控制
      认证                                鉴权         | - - - > 权限 - - - - - > 数据权限 - - - - > 数据库
   Authentication                    Authorization    |                  |
                                                      |                  |
用户 ->  登录 - - - - - - - - - - -| -> 角色  - - - - - | - - - > 接口 - - 访问控制
                                        |             |
API请求 - Guard -> PolicyService - |     |             | - - - > 菜单 - - - - > 菜单权限
                                      数据库 < - - - - - - - - - -

```

- 接口 策略 与 用户角色 策略 全部满足，说明，该用户可以访问，该接口

```lua

                    用户角色
       policy1      ability1

       policy2      ability2
接口                             权限
       policy3      ability3

       policy4      ability4
```
