# 登录注册

## 流程

```lua
                                     Controller

        请求               | - - >  AuthController   - - >  AuthService         Auth模块
        POST          - - |
登录    /auth/signin                                             |
                                                                V
        请求
        POST
注册    /auth/signup   - - |        UsersController         UsersService - - > UsersRepository
```

## 创建模块

```sh
nest g mo auth -d # --dry-run
nest g s auth/auth --flat  # service
nest g co auth/auth --flat --no-spec  # controller
```

- 两个模块之间如何互相调用: auth 模块如何使用 UserRepository ?

```ts
// user.module.ts
@Module({
  imports,
  providers: [...providers, UserRepository],
  controllers: [UserController],
  exports: [UserRepository], // 导出后，可以在 Auth 等其他模块中使用
})
export class UserModule {}
```

```ts
// auth.module.ts
@Module({
  imports: [UserModule], // 导入 UserModule 模块
  controllers: [AuthController],
  providers: [AuthService],
})
export class AuthModule {}
```
